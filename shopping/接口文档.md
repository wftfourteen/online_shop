## 1. 用户认证模块

### 1.1 用户注册

#### 1.1.1**基本信息**

**请求路径**： `/register`
**请求方式**： `POST`
**接口描述**： 用户注册接口，完成新用户账号创建



#### 1.1.2**请求参数**

**参数格式**： `application/json`

**参数说明：**

| 参数名   | 类型   | 是否必须 | 备注                                  |
| :------- | :----- | :------- | :------------------------------------ |
| username | string | 必须     | 用户名，不能使用@符号~~，3-20位字符~~ |
| email    | string | 必须     | 邮箱地址                              |
| password | string | 必须     | 密码~~，8-20位字符~~                  |
| avatar   | string | 非必须   | 头像url                               |
| role     | number | 必须     | 角色，1顾客；2商家                    |

**请求参数样例：**

```json
{
  "username": "testuser",
  "email": "test@example.com",
  "password": "password123",
  "role":1
}
```



#### 1.1.3**响应数据**

**参数格式**： `application/json`

**参数说明：**

| 参数名 | 类型   | 是否必须 | 备注                 |
| :----- | :----- | :------- | :------------------- |
| code   | number | 必须     | 响应码，1成功，0失败 |
| msg    | string | 非必须   | 提示信息             |
| data   | object | 非必须   | 返回数据             |

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "success",
  "data": null
}
```



**错误响应样例：**

```json
{
  "code": 0,
  "msg": "用户名已存在",
  "data": null
}
```



------

### 1.2 用户名验证接口

#### 1.2.1 基本信息

**请求路径：** `/register/check-username`
**请求方式：** `GET`
**接口描述：** 实时校验用户名是否可用



#### 1.2.2 请求参数

**参数格式：** `Query Parameters`

**参数说明：**

| 参数名   | 类型   | 是否必须 | 备注           |
| :------- | :----- | :------- | :------------- |
| username | string | 必须     | 要验证的用户名 |

**请求参数样例：**

```
/register/check-username?username=testuser
```



#### 1.2.3 响应数据

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "success",
  "data": null
}
```



```json
{
  "code": 0,
  "msg": "用户名已存在",
  "data": null
}
```



------

### 1.3 邮箱验证接口

#### 1.3.1 基本信息

**请求路径：** `/register/check-email`
**请求方式：** `GET`
**接口描述：** 实时校验邮箱是否可用



#### 1.3.2 请求参数

**参数格式：** `Query Parameters`

**参数说明：**

| 参数名 | 类型   | 是否必须 | 备注         |
| :----- | :----- | :------- | :----------- |
| email  | string | 必须     | 要验证的邮箱 |

**请求参数样例：**

```
/register/check-email?email=test@example.com
```



#### 1.3.3 响应数据

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "success",
  "data": null
}

{
  "code": 0,
  "msg": "邮箱已注册",
  "data": null
}
```



------

### 1.4 用户登录接口

#### 1.4.1 基本信息

**请求路径：** `/login`
**请求方式：** `POST`
**接口描述：** 用户登录接口，支持用户名或邮箱登录



#### 1.4.2 请求参数

**参数格式：** `application/json`

**参数说明：**

| 参数名   | 类型   | 是否必须 | 备注         |
| :------- | :----- | :------- | :----------- |
| account  | string | 必须     | 用户名或邮箱 |
| password | string | 必须     | 密码         |

**请求参数样例：**

```json
{
  "account": "testuser",
  "password": "password123"
}
```



#### 1.4.3 响应数据

**参数格式：** `application/json`

**参数说明：**

| 名称         | 类型   | 是否必须 | 备注                    |
| ------------ | ------ | -------- | ----------------------- |
| code         | number | 必须     | 响应码, 1 成功 ; 0 失败 |
| msg          | string | 非必须   | 提示信息                |
| data         | object | 必须     | 返回的数据              |
| \|- userId   | number | 必须     | 用户ID                  |
| \|- username | string | 必须     | 用户名                  |
| \|- role     | number | 必须     | 用户角色，1顾客；2商家  |
| \|- avatar   | string | 必须     | 头像                    |
| \|- token    | string | 必须     | 令牌                    |

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "userId": 1,
    "username": "testuser",
    "role": 1,
    "avatar": "/avatars/default-avatar.png",
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```



**错误响应样例：**

```json
{
  "code": 0,
  "msg": "账号或密码不正确",
  "data": null
}
```



------

### 1.5 获取用户信息接口

#### 1.5.1 基本信息

**请求路径：** `/user`
**请求方式：** `GET`
**接口描述：** 获取当前登录用户的个人信息
**认证要求：** 需要JWT Token



#### 1.5.2 请求参数

无



#### 1.5.3 响应数据

**参数格式：** `application/json`

**参数说明：**

| 名称         | 类型   | 是否必须 | 备注                    |
| ------------ | ------ | -------- | ----------------------- |
| code         | number | 必须     | 响应码, 1 成功 ; 0 失败 |
| msg          | string | 非必须   | 提示信息                |
| data         | object | 必须     | 返回的数据              |
| \|- userId   | number | 必须     | 用户ID                  |
| \|- username | string | 必须     | 用户名                  |
| \|- email    | string | 必须     | 邮箱                    |
| \|- avatar   | string | 必须     | 头像                    |
| \|- role     | number | 必须     | 用户角色，1顾客；2商家  |
| \|- status   | number | 必须     | 状态，1正常；0禁用      |

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "userId": 1,
    "username": "testuser",
    "email": "test@example.com",
    "avatar": "/avatars/testuser.jpg",
    "role": 1,
    "status": 1
  }
}
```



------

### 1.6 更新用户信息接口

#### 1.6.1 基本信息

**请求路径：** `/user`
**请求方式：** `PUT`
**接口描述：** 更新用户个人信息
**认证要求：** 需要JWT Token



#### 1.6.2 请求参数

**参数格式：** `application/json`

**参数说明：**

| 参数名   | 类型   | 是否必须 | 备注   |
| :------- | :----- | :------- | :----- |
| username | string | 非必须   | 用户名 |

**请求参数样例：**

```json
{
  "username": "newname"
}
```



#### 1.6.3 响应数据

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "success",
  "data": null
}
```



------

### 1.7 头像上传接口

#### 1.7.1 基本信息

**请求路径：** `/user/avatar`
**请求方式：** `POST`
**接口描述：** 上传用户头像
**认证要求：** 需要JWT Token



#### 1.7.2 请求参数

**参数格式：** `multipart/form-data`

**参数说明：**

| 参数名 | 类型 | 是否必须 | 备注                        |
| :----- | :--- | :------- | :-------------------------- |
| avatar | file | 必须     | 头像文件，支持JPG/PNG，≤5MB |



#### 1.7.3 响应数据

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "头像上传成功",
  "data": {
    "avatarUrl": "/avatars/12345.jpg"
  }
}
```



------

### 1.8 退出登录接口

#### 1.8.1 基本信息

**请求路径：** `/user/logout`
**请求方式：** `POST`
**接口描述：** 用户退出登录
**认证要求：** 需要JWT Token



#### 1.8.2 请求参数

无



#### 1.8.3 响应数据

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "success",
  "data": null
}
```



## 2. 商品模块

### 2.1 获取商品列表接口

#### 2.1.1 基本信息

**请求路径**： `/products`

**请求方式**： `GET`

**接口描述**： 获取商品列表，支持价格区间筛选、排序和分页，用于商品列表页展示



#### 2.1.2 请求参数

**参数格式**： `Query Parameters`

**参数说明：**

| 参数名   | 类型   | 是否必须 | 备注                                                         |
| -------- | ------ | -------- | ------------------------------------------------------------ |
| minPrice | number | 非必须   | 价格下限，与 maxPrice 配合使用筛选价格区间（对应商品表`price`字段） |
| maxPrice | number | 非必须   | 价格上限，与 minPrice 配合使用筛选价格区间（对应商品表`price`字段） |
| sort     | string | 非必须   | 排序方式，default - 默认；price_asc - 价格低到高；price_desc - 价格高到低（默认 default） |
| page     | number | 必须     | 页码，从 1 开始                                              |
| pageSize | number | 必须     | 每页商品数量                                                 |

**请求参数样例：**

```plaintext
/products?minPrice=100&maxPrice=500&sort=price_asc&page=1&pageSize=12
```



#### 2.1.3 响应数据

**参数格式**： `application/json`

**参数说明：**

| 参数名           | 类型   | 是否必须 | 备注                                                         |
| ---------------- | ------ | -------- | ------------------------------------------------------------ |
| code             | number | 必须     | 响应码，1 成功，0 失败                                       |
| msg              | string | 必须     | 提示信息                                                     |
| data             | object | 必须     | 返回数据                                                     |
| \|- list         | array  | 必须     | 商品列表（基于商品表`products`筛选上架状态（`status=1`）的数据） |
| \| \|- productId | number | 必须     | 商品 ID（对应商品表`product_id`）                            |
| \| \|- mainImage | string | 必须     | 商品主图 url（对应商品表`main_image`）                       |
| \| \|- name      | string | 必须     | 商品名称（对应商品表`name`）                                 |
| \| \|- price     | number | 必须     | 商品现价（对应商品表`price`）                                |
| \| \|- stock     | number | 必须     | 库存数量                                                     |
| \|- total        | number | 必须     | 总商品数（符合筛选条件的上架商品总数）                       |
| \|- totalPage    | number | 必须     | 总页数（`Math.ceil(total / pageSize)`）                      |
| \|- currentPage  | number | 必须     | 当前页码                                                     |

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "list": [
      {
        "productId": 1,
        "mainImage": "/images/product1.jpg",
        "name": "示例商品1",
        "price": 299.99,
        "stockStatus": 15
      },
      {
        "productId": 2,
        "mainImage": "/images/product2.jpg",
        "name": "示例商品2（超出两行文本时会显示省略号）",
        "price": 399.99,
        "stockStatus": 2
      }
    ],
    "total": 45,
    "totalPage": 4,
    "currentPage": 1
  }
}
```



```json
{
  "code": 0,
  "msg": "暂无符合条件的商品",
  "data": {
    "list": [],
    "total": 0,
    "totalPage": 0,
    "currentPage": 1
  }
}
```



### 2.2 获取商品详情接口

#### 2.2.1 基本信息

**请求路径**： `/products/{productId}`

**请求方式**： `GET`

**接口描述**： 获取商品详情信息，用于商品详情页展示，包括基本信息、图片、规格等



#### 2.2.2 请求参数

**参数格式**： `Path Parameters`

**参数说明：**

| 参数名    | 类型   | 是否必须 | 备注                              |
| --------- | ------ | -------- | --------------------------------- |
| productId | number | 必须     | 商品 ID（对应商品表`product_id`） |

**请求参数样例：**

```plaintext
/products/1
```



#### 2.2.3 响应数据

**参数格式**： `application/json`

**参数说明：**

| 参数名          | 类型   | 是否必须 | 备注                                                         |
| --------------- | ------ | -------- | ------------------------------------------------------------ |
| code            | number | 必须     | 响应码，1 成功，0 失败                                       |
| msg             | string | 必须     | 提示信息                                                     |
| data            | object | 必须     | 返回数据（基于商品表`products`数据）                         |
| \|- productId   | number | 必须     | 商品 ID（对应商品表`product_id`）                            |
| \|- name        | string | 必须     | 商品名称（对应商品表`name`）                                 |
| \|- price       | number | 必须     | 商品现价（对应商品表`price`）                                |
| \|- stock       | number | 必须     | 库存数量（对应商品表`stock`）                                |
| \|- images      | array  | 必须     | 商品图片列表（url），第一个为主图，后续为详情图（解析商品表`detail_images`JSON 数组，若为 null 则仅包含主图） |
| \|- description | String | 必须     | 商品描述                                                     |

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "productId": 1,
    "name": "示例商品详情",
    "price": 299.99,
    "stock": 8,
    "images": [
      "/images/product1.jpg",  // 主图（对应main_image）
      "/images/detail1.jpg",   // 详情图（解析detail_images）
      "/images/detail2.jpg"
    ],
    "description": "<p>商品详细描述内容...</p>" // 对应description
  }
}
```



### 2.3 加入购物车接口

#### 2.3.1 基本信息

**请求路径**： `/cart`

**请求方式**： `POST`

**接口描述**： 商品详情页将商品加入购物车功能

**认证要求**： 需要 JWT Token



#### 2.3.2 请求参数

**参数格式**： `application/json`

**参数说明：**

| 参数名    | 类型   | 是否必须 | 备注                                                   |
| --------- | ------ | -------- | ------------------------------------------------------ |
| productId | number | 必须     | 商品 ID（对应商品表`product_id`）                      |
| quantity  | number | 必须     | 购买数量，1≤quantity≤商品库存（基于商品表`stock`校验） |

**请求参数样例：**

```json
{
  "productId": 1,
  "quantity": 2
}
```



#### 2.3.3 响应数据

**参数格式**： `application/json`

**响应数据样例：**

```json
{
  "code": 1,
  "msg": "已加入购物车",
  "data": null
}
```

**错误响应样例：**

```json
{
  "code": 0,
  "msg": "库存不足，最大可购买 3 件",  // 基于商品表`stock`判断
  "data": null
}
```