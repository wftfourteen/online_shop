### 在线购物网站 - 产品需求文档（PRD）

------

#### 1. 📄 文档概述

| 字段     | 内容                               |
| -------- | ---------------------------------- |
| 文档名称 | 在线购物网站 - 产品需求文档（PRD） |
| 作者     | wft                                |
| 创建时间 | 2025 年 6 月 5 日                  |
| 当前版本 | v1.0                               |

------

#### 2. 🎯 产品目标与背景

##### 2.1 背景说明

随着电子商务的蓬勃发展，用户对于在线购物的需求日益增长，现有购物平台存在功能分散、用户体验不佳、性能瓶颈等问题。为满足用户便捷、安全、高效的购物需求，需开发一套功能完善、性能稳定的在线购物网站，整合用户认证、商品展示、购物车、订单管理、支付通知及后台管理等核心功能模块，覆盖从浏览商品到售后管理的全流程场景。

##### 2.2 产品目标

- 打造一站式在线购物平台，实现从商品浏览、加购、下单到支付的完整交易流程
- 提供安全可靠的多维度用户认证体系，支持账号密码、第三方登录等多种方式
- 构建高效精准的商品展示与搜索系统，提升用户找货效率与购物体验
- 实现灵活便捷的购物车与订单管理功能，满足用户日常购物及售后需求
- 集成多元支付渠道与实时通知机制，保障交易安全与信息及时触达
- 开发功能全面的后台管理系统，支持商品、订单、用户全生命周期运营管理

------

#### 3. 👤 用户与使用场景

##### 3.1 用户角色

| 角色     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 普通用户 | 在平台注册账号，进行商品浏览、加购、下单、支付、售后等操作的个人用户 |
| 管理员   | 负责平台商品上下架、库存管理、订单处理、用户管理、数据统计的运营 / 管理人员 |
| 访客用户 | 未登录状态下，可浏览商品列表、查看商品详情、添加临时购物车的用户 |

##### 3.2 使用场景

- 普通用户：注册账号→登录平台→浏览 / 搜索商品→查看商品详情→添加购物车→确认订单→选择支付方式完成支付→接收发货通知→确认收货→查看订单历史
- 访客用户：浏览商品列表→添加商品到临时购物车→登录 / 注册后同步购物车数据→继续下单流程
- 管理员：添加 / 编辑商品信息→设置商品库存与上下架状态→查看待处理订单→处理发货→查看销售数据报表→管理用户账号状态

------

#### 4. 📋 功能清单（核心）

| 编号 | 功能模块       | 功能名称         | 详细描述                                                     | 优先级 |
| ---- | -------------- | ---------------- | ------------------------------------------------------------ | ------ |
| F-01 | 用户认证系统   | 用户注册         | 支持邮箱 / 用户名 + 密码注册，含基础信息验证、重复注册校验   | 高     |
| F-02 | 用户认证系统   | 用户登录         | 支持邮箱 / 用户名 + 密码登录、第三方登录，含 Session/JWT 令牌管理、登录状态持久化 | 高     |
| F-03 | 用户认证系统   | 用户注销         | 安全退出账号，清理用户会话数据                               | 高     |
| F-04 | 用户认证系统   | 第三方登录集成   | 支持 GitHub OAuth 登录、微信扫码登录，首次登录自动注册       | 中     |
| F-05 | 用户认证系统   | 安全增强功能     | 密码强度检测、登录失败次数限制、会话超时管理                 | 高     |
| F-06 | 用户认证系统   | 用户资料管理     | 支持头像上传（OSS 集成）、个人信息编辑（昵称、手机号、邮箱等） | 中     |
| F-07 | 商品展示系统   | 商品列表展示     | 分页展示商品，包含商品图片、名称、价格、评分、库存状态等核心信息 | 高     |
| F-08 | 商品展示系统   | 商品分类筛选     | 按一级 / 二级分类筛选商品，支持多分类组合筛选                | 高     |
| F-09 | 商品展示系统   | 基础商品搜索     | 支持关键词搜索，实现基础模糊匹配，返回相关商品列表           | 高     |
| F-10 | 商品展示系统   | 高级搜索功能     | 支持多条件组合搜索（价格区间、分类、品牌、销量、评分），支持搜索历史记录 | 中     |
| F-11 | 商品展示系统   | 商品推荐系统     | 基于用户浏览历史推荐、热门商品推荐、相关商品推荐             | 中     |
| F-12 | 商品展示系统   | 性能优化功能     | 商品图片懒加载、商品列表缓存、搜索关键词索引优化             | 高     |
| F-13 | 商品展示系统   | 商品详情页展示   | 展示完整商品信息（图文介绍、规格参数、售后政策）、库存状态、评价列表 | 高     |
| F-14 | 购物车系统     | 添加商品到购物车 | 支持选择商品规格、数量，添加前校验库存                       | 高     |
| F-15 | 购物车系统     | 购物车管理       | 查看购物车商品、修改商品数量、删除商品、选择 / 取消选择商品  | 高     |
| F-16 | 购物车系统     | 价格计算         | 实时计算选中商品总价、优惠金额、实付金额                     | 高     |
| F-17 | 购物车系统     | 购物车数据同步   | 支持本地与服务器数据同步，未登录用户临时购物车登录后自动合并 | 中     |
| F-18 | 购物车系统     | 智能推荐         | 显示 “买了此商品的人也买了” 相关商品推荐                     | 低     |
| F-19 | 购物车系统     | 缺货预警         | 购物车中商品库存不足时触发预警提示，超库存商品无法提交订单   | 中     |
| F-20 | 购物车系统     | 购物车分享       | 生成购物车分享链接，支持多人协作编辑购物车                   | 低     |
| F-21 | 订单管理系统   | 订单创建         | 从购物车选中商品生成订单，支持收货地址管理、优惠券选择、备注添加 | 高     |
| F-22 | 订单管理系统   | 订单状态管理     | 支持订单状态流转（待支付→已支付→已发货→已完成），支持订单取消、申请退款 | 高     |
| F-23 | 订单管理系统   | 订单查询         | 支持按订单状态、时间范围、订单号查询，查看订单历史及详情     | 高     |
| F-24 | 订单管理系统   | 订单拆单能力     | 多商家商品、超库存商品自动拆分为多个子订单                   | 中     |
| F-25 | 订单管理系统   | 订单部分退款     | 支持按商品维度申请部分退款，退款后更新订单状态与金额         | 中     |
| F-26 | 订单管理系统   | 订单时效管理     | 待支付订单 30 分钟超时自动取消，待收货订单 7 天超时自动确认收货 | 高     |
| F-27 | 订单管理系统   | 订单数据分析     | 支持购买趋势分析、用户购买行为分析，生成数据报表             | 低     |
| F-28 | 支付与通知系统 | 支付流程         | 集成模拟支付接口，支持支付状态实时更新，支付结果同步至订单   | 高     |
| F-29 | 支付与通知系统 | 邮件通知         | 订单确认、发货、退款等状态变更时发送邮件通知，使用 NodeMailer 实现 | 中     |
| F-30 | 支付与通知系统 | 支付集成         | 集成支付宝沙箱、微信支付模拟接口，支持真实支付流程测试       | 中     |
| F-31 | 支付与通知系统 | 多渠道通知       | 支持短信通知（阿里云短信服务）、WebSocket 实时通知（订单状态变更） | 低     |
| F-32 | 支付与通知系统 | 消息队列         | 使用 Redis 实现异步邮件 / 短信发送，支持通知失败重试机制     | 中     |
| F-33 | 后台管理系统   | 商品管理         | 支持商品增删改查、商品上下架、库存调整、规格管理、图片上传   | 高     |
| F-34 | 后台管理系统   | 订单管理         | 支持订单列表查看、订单状态修改、发货操作、退款审核、订单备注添加 | 高     |
| F-35 | 后台管理系统   | 销售统计         | 支持基础销售额统计、订单数量统计、客单价统计                 | 中     |
| F-36 | 后台管理系统   | 高级数据统计     | 销售数据可视化（ECharts 图表）、热销商品分析、用户购买力分析 | 低     |
| F-37 | 后台管理系统   | 批量操作         | 支持商品批量上架 / 下架、订单批量发货、批量导出订单数据      | 中     |
| F-38 | 后台管理系统   | 系统监控         | 支持操作日志记录（用户操作、系统操作）、系统性能监控（响应时间、并发量） | 中     |
| F-39 | 后台管理系统   | 用户管理         | 支持用户列表查看、用户信息编辑、账号禁用 / 启用、用户搜索    | 中     |

------

#### 5. 🔄 功能流程图

##### 5.1 用户注册流程

css

```css
graph TD
A[点击注册按钮] --> B[填写用户名/邮箱、密码、确认密码]
B --> C[实时校验字段合法性]
C -->|格式错误| D[显示错误提示，返回修改]
C -->|格式正确| E[点击提交注册]
E --> F[校验是否重复注册]
F -->|已注册| G[提示“账号已存在”，跳转登录]
F -->|未注册| H[密码加密存储，创建用户账号]
H --> I[注册成功，自动跳转登录页]
```

##### 5.2 用户购物核心流程

css

```css
graph TD
A[用户登录/访客浏览] --> B[浏览商品列表/搜索商品]
B --> C[查看商品详情]
C --> D[选择规格和数量，添加到购物车]
D -->|未登录| E[存入临时购物车]
D -->|已登录| F[存入账号购物车，同步至服务器]
E -->|登录后| F
F --> G[进入购物车，确认商品（修改/删除/选择）]
G --> H[点击“结算”，进入订单确认页]
H --> I[选择收货地址、优惠券，填写备注]
I --> J[提交订单，生成待支付订单]
J --> K[选择支付方式，完成支付]
K --> L[支付成功，订单状态更新为“已支付”]
L --> M[商家发货，订单状态更新为“已发货”]
M --> N[用户确认收货，订单状态更新为“已完成”]
```

##### 5.3 订单状态流转流程

css

```css
graph TD
A[创建订单] --> B[待支付]
B -->|30分钟内未支付| C[自动取消]
B -->|完成支付| D[已支付]
D -->|商家发货| E[已发货]
E -->|用户确认收货| F[已完成]
E -->|用户申请退款| G[退款中]
G -->|退款审核通过| H[已退款，订单关闭]
G -->|退款审核拒绝| E
D -->|未发货前用户取消| C
```

------

#### 6. 🧩 页面说明与交互细节（按模块拆）

##### 6.1 用户认证系统页面

###### 页面 1：注册页

- **入口**：首页顶部 “注册” 按钮、登录页 “立即注册” 链接
- **字段说明**：
  - 用户名：必填，3-20 位字符~~（支持字母、数字、下划线，不能以数字开头）~~
  - 邮箱：必填，符合 RFC 标准邮箱格式（含 @及域名后缀）
  - 密码：必填，8-20 位，~~需包含大写字母 + 小写字母 + 数字（可选含特殊字符）~~
  - 确认密码：必填，与密码输入内容完全一致
- **校验规则**：
  - 实时校验用户名：输入时提示 “用户名已被占用” 或 “格式正确”
  - 实时校验邮箱：输入时提示 “邮箱格式错误” 或 “邮箱已被注册”
  - ~~实时校验密码：输入时显示密码强度（弱 / 中 / 强），不符合规则则提示 “密码需包含大写字母、小写字母和数字，长度 8-20 位”~~
  - 确认密码实时校验：与密码不一致时提示 “两次输入密码不一致”
- **交互逻辑**：
  - 所有字段未填写时，注册按钮置灰不可点击
  - 点击注册按钮时，再次校验所有字段，校验通过后提交注册请求
  - 错误提示显示在对应字段下方，红色字体；成功提示为绿色浮动框，3 秒后自动消失
  - 注册成功后，自动跳转至登录页，附带 “注册成功，请登录” 提示

###### 页面 2：登录页

- **入口**：首页顶部 “登录” 按钮、加入购物车未登录触发跳转
- **字段说明**：
  - 账号：必填，支持用户名 / 邮箱输入
  - 密码：必填，8-20 位字符（隐藏输入，支持显示密码切换）
- ~~**功能选项**：~~
  - ~~记住登录状态：勾选后，下次访问自动登录（有效期 7 天）~~
  - ~~忘记密码：点击跳转至密码找回页~~
  - ~~第三方登录：GitHub 图标、微信扫码登录图标（悬浮显示 “GitHub 登录”/“微信登录” 提示）~~
- **校验规则**：
  - 账号为空提示 “请输入用户名或邮箱”
  - 密码为空提示 “请输入密码”
  - 账号或密码错误提示 “账号或密码不正确”
  - 登录失败次数≥5 次，提示 “登录失败次数过多，请 2 分钟后再试”，账号锁定 2 分钟
- **交互逻辑**：
  - 点击 “显示密码” 图标，密码明文显示；再次点击隐藏
  - 点击第三方登录图标，GitHub 登录跳转至授权页面，微信登录显示扫码弹窗
  - 第三方登录首次授权后，自动创建账号并登录，跳转至首页
  - 登录成功后，根据跳转来源页面返回（如从购物车跳转则返回购物车）

###### 页面 3：个人中心 - 资料管理页

- **入口**：首页顶部用户头像下拉菜单→“个人资料”
- **字段说明**：
  - 头像：显示当前头像，支持上传新头像（点击头像弹出上传弹窗）
  - 昵称：可编辑，3-20 位字符，默认显示用户名
  - ~~手机号：可绑定 / 修改（未绑定显示 “立即绑定”，已绑定显示号码后 4 位，点击 “修改” 触发验证码校验）~~
  - 邮箱：显示已注册邮箱，支持修改（点击 “修改” 跳转至邮箱修改页，需密码校验）
- **交互逻辑**：
  - 头像上传支持 JPG/PNG 格式，大小≤5MB，上传后支持裁剪（默认圆形裁剪框）
  - 昵称修改后，实时保存并更新页面显示，提示 “修改成功”
  - ~~绑定 / 修改手机号时，需输入短信验证码（6 位，60 秒内可重发），校验通过后更新手机号~~
  - 所有修改操作无需单独点击 “保存” 按钮，实时生效，减少操作步骤
  - 点击“退出登录”按钮可退出登录，前端清除Token和状态，并跳转首页

##### 6.2 商品展示系统页面

###### 页面 1：商品列表页

- **入口**：首页分类菜单点击分类名称、搜索结果跳转
- **页面结构**：
  - 筛选栏（顶部 + 左侧）：
    - 顶部筛选：价格区间（输入框）、排序方式（默认 / 价格低到高 / 价格高到低 / ~~销量高到低 / 评分高到低~~）
    - ~~左侧筛选：分类（二级分类勾选，支持多分类选择）、品牌（多选，支持搜索品牌）、库存状态（有货 / 预售）~~
  - 商品展示区：网格布局（默认 4 列，移动端自适应 2 列），每列显示商品卡片
  - 分页控件：底部显示当前页码、总页数、总商品数，支持上下页切换、直接输入页码跳转
- **商品卡片元素**：
  - 商品图片：默认显示主图~~，hover 时切换为第二张图~~
  - 商品名称：最多显示 2 行，超出部分省略号显示
  - 商品价格：红色字体显示现价
  - ~~销量：灰色小字体显示 “已售 XX”~~
  - ~~评分：星级显示（1-5 星），无评分显示 “暂无评分”~~
  - 库存状态：无货商品显示 “暂无库存” 水印，不可点击加购
- **交互逻辑**：
  - ~~滚动页面至商品卡片出现在视口时，加载商品图片（懒加载）~~
  - 筛选条件变更时，实时刷新商品列表，保留当前页码（筛选后无数据时显示 “暂无符合条件的商品”）
  - 点击商品卡片任意位置，跳转至商品详情页
  - 点击排序方式，当前选中项高亮显示，商品列表按选中规则重新排序
  - 分页切换时，保留当前筛选条件和排序方式

###### 页面 2：商品详情页

- **入口**：商品列表页点击商品卡片
- **页面结构**：
  - 商品图文区：左侧商品图片（支持放大查看），右侧商品基本信息
  - 商品规格区：选择商品规格（如颜色、尺寸）、输入购买数量
  - 操作区：加入购物车按钮、立即购买按钮、~~收藏商品按钮~~
  - 商品详情区：图文详情（支持富文本显示）、规格参数、售后政策
  - ~~评价列表区：显示用户评价（含评分、图文、购买规格），支持分页~~
  - ~~相关推荐区：显示 “猜你喜欢” 相关商品卡片（4 列布局）~~
- **字段说明**：
  - 商品名称：大字体显示，下方显示商品 SKU 编码（灰色小字体）
  - 价格：现价（红色大字体）
  - 库存状态：显示 “库存 XX 件”，库存≤10 件时提示 “库存紧张”
  - 规格选择：多个规格维度（如颜色、尺寸），未选择时提示 “请选择商品规格”
  - 购买数量：默认 1 件，支持点击 “+”“-” 按钮增减，最小值 1，最大值≤库存数量
- **交互逻辑**：
  - 商品图片轮播：点击左右箭头切换图片，双击图片放大至全屏查看，支持左右滑动切换
  - 规格选择：选中规格后高亮显示，未选择所有必填规格时，加入购物车和立即购买按钮置灰
  - 购买数量：点击 “-” 按钮至 1 时，按钮置灰不可再减；输入数量超过库存时，提示 “库存不足，最大可购买 XX 件”，自动修正为最大库存
  - 加入购物车：点击后，校验规格和数量，成功后显示 “已加入购物车” 浮动提示，购物车图标数字 + 1
  - 立即购买：点击后，直接跳转至订单确认页，带入当前选择的商品规格和数量

##### 6.3 购物车系统页面

- **入口**：首页顶部 “购物车” 图标（显示商品数量角标）
- **页面结构**：
  - 购物车为空区：显示购物车空图标、“你的购物车还是空的” 提示、“去逛逛” 按钮（跳转至商品列表页）
  - 购物车商品列表区：每个商品为一行，包含商品勾选框、商品图片、名称、规格、单价、数量、小计、删除按钮
  - 结算区：固定在页面底部，包含全选勾选框、已选商品数量、总价计算、结算按钮
- **字段说明**：
  - 勾选框：支持单个商品勾选 / 取消，全选勾选框控制所有商品勾选状态
  - 商品信息：显示商品缩略图、名称（超出 1 行省略）、选择的规格（如 “颜色：黑色 尺寸：L”）
  - 单价：显示商品当前单价（原价 / 优惠价）
  - 数量控制：“-”“+” 按钮 + 输入框，数量范围 1 - 库存数量
  - 小计：实时计算（单价 × 数量），红色字体
  - 删除按钮：hover 显示 “删除” 文字，点击弹出确认弹窗 “确定要删除该商品吗？”
- **交互逻辑**：
  - 单个商品勾选状态变更时，实时更新已选商品数量和总价
  - 全选勾选框：勾选后所有商品勾选；取消勾选后所有商品取消勾选；所有商品手动勾选后，全选框自动勾选
  - 数量修改：点击 “+” 按钮，数量 + 1，超过库存时提示 “库存不足”；点击 “-” 按钮，数量 - 1，至 1 时按钮置灰；输入数量时，实时校验是否为正整数且≤库存，不符合则提示 “请输入有效数量”
  - 商品缺货时：数量控制置灰不可修改，勾选框置灰不可勾选，显示 “暂无库存” 提示，小计金额显示为 0
  - 点击删除按钮：弹出确认弹窗，点击 “确定” 删除商品，购物车数量更新；点击 “取消” 关闭弹窗
  - 结算按钮：已选商品数量为 0 时置灰不可点击；有选中商品时可点击，跳转至订单确认页（未登录时跳转至登录页）
  - 未登录状态：购物车商品存储在本地，登录后自动合并至服务器购物车（去重，保留最大数量）

##### 6.4 订单管理系统页面

###### 页面 1：订单确认页

- **入口**：购物车页面 “结算” 按钮
- **页面结构**：
  - 收货地址区：显示当前选中地址，支持 “修改地址”“添加新地址”
  - 商品清单区：显示选中的商品（图片、名称、规格、单价、数量、小计）
  - 订单金额区：显示商品总价、优惠金额、运费、实付金额
  - 优惠券区：显示 “选择优惠券”，支持下拉选择可用优惠券
  - 备注区：输入框，提示 “请输入订单备注（如送货时间、特殊要求等）”
  - 支付方式选择区：支付宝、微信支付选项（单选）
  - 提交订单按钮：固定在底部
- **字段说明**：
  - 收货地址：显示收货人、手机号、详细地址，无地址时显示 “请添加收货地址”，点击跳转至地址添加页
  - 商品小计：按购物车选中商品计算，不可修改
  - 优惠金额：默认 0，选择优惠券后显示优惠券抵扣金额
  - 运费：满 88 元免运费，不满则显示 10 元运费（可配置）
  - 实付金额：商品总价 - 优惠金额 + 运费（≥0）
- **交互逻辑**：
  - 无收货地址时，提交订单按钮置灰，提示 “请添加收货地址”
  - 选择优惠券时，下拉显示可用优惠券列表（含优惠券金额、使用条件），选中后实时更新优惠金额和实付金额
  - 支付方式默认选中支付宝，点击切换时，选中项高亮显示
  - 备注输入框最多输入 200 字，超出时提示 “备注内容不能超过 200 字”
  - 点击提交订单按钮，生成待支付订单，跳转至支付页，订单有效期 30 分钟

###### 页面 2：订单列表页

- **入口**：个人中心→“我的订单”
- **页面结构**：
  - 订单筛选栏：按订单状态筛选（全部、待支付、已支付、已发货、已完成、已取消）、按时间筛选（近 7 天、近 30 天、自定义时间）
  - 订单列表区：每个订单为一个卡片，显示订单号、下单时间、订单状态、商品信息、订单金额、操作按钮
- **订单卡片元素**：
  - 订单号：显示 “订单号：XXX”，右侧支持 “复制订单号” 按钮
  - 下单时间：显示 “下单时间：YYYY-MM-DD HH:MM:SS”
  - 订单状态：标签形式（待支付 - 橙色、已支付 - 蓝色、已发货 - 绿色、已完成 - 灰色、已取消 - 红色）
  - 商品信息：显示商品缩略图、名称、规格、数量（多商品时显示 “共 X 件商品”，点击展开查看所有商品）
  - 订单金额：显示 “实付：¥XXX”
  - 操作按钮：根据订单状态显示不同按钮（待支付 -“支付”“取消订单”；已支付 -“申请退款”“查看物流”；已发货 -“确认收货”“查看物流”；已完成 -“查看详情”“再次购买”；已取消 -“查看详情”）
- **交互逻辑**：
  - 筛选条件变更时，实时刷新订单列表
  - 点击订单卡片除操作按钮外的区域，跳转至订单详情页
  - 点击 “取消订单”，弹出确认弹窗 “确定要取消该订单吗？”，取消后订单状态变更为 “已取消”
  - 点击 “再次购买”，将订单中的商品添加至购物车，跳转至购物车页面
  - 订单列表支持下拉刷新，加载更多订单（分页加载，每页 10 条）

##### 6.5 后台管理系统页面

###### 页面 1：商品管理 - 商品列表页

- **入口**：后台管理系统左侧菜单→“商品管理”→“商品列表”
- **页面结构**：
  - 操作区：添加商品按钮、批量操作下拉框（批量上架、批量下架、批量删除）
  - 搜索筛选区：商品名称搜索框、分类筛选下拉框、上下架状态筛选、创建时间筛选
  - 商品列表表格：包含商品 ID、商品名称、分类、价格、库存、上下架状态、创建时间、操作列
- **表格操作列**：
  - 编辑：跳转至商品编辑页
  - 上下架：当前为上架状态显示 “下架”，点击后变更为下架状态；反之显示 “上架”
  - 查看：跳转至商品详情页（前台页面）
  - 删除：点击弹出确认删除弹窗
- **交互逻辑**：
  - 勾选表格左侧复选框，可选择多个商品，批量操作下拉框激活（未勾选时置灰）
  - 点击 “添加商品” 按钮，跳转至商品添加页
  - 搜索框支持模糊搜索，输入商品名称关键词后回车或点击搜索按钮刷新列表
  - 上下架状态切换后，实时更新表格状态，无需刷新页面
  - 表格支持分页，每页 20 条，底部显示分页控件

###### 页面 2：订单管理 - 订单处理页

- **入口**：后台管理系统左侧菜单→“订单管理”→“订单列表”
- **页面结构**：
  - 搜索筛选区：订单号搜索、用户账号搜索、订单状态筛选、下单时间筛选
  - 订单列表表格：包含订单 ID、用户账号、订单金额、下单时间、订单状态、收货地址、操作列
- **表格操作列**：
  - 查看详情：弹出订单详情弹窗（显示商品清单、支付信息、收货信息）
  - 发货：仅待发货状态显示，点击跳转至发货操作页
  - 退款处理：仅退款中状态显示，点击弹出退款审核弹窗
- **交互逻辑**：
  - 点击 “发货” 按钮，跳转至发货页，填写物流公司、物流单号，提交后订单状态变更为 “已发货”
  - 点击 “退款处理”，弹窗显示退款申请信息（商品、金额、原因），支持 “同意退款”“拒绝退款” 操作，操作后更新订单状态
  - 订单详情弹窗支持打印订单信息（点击打印按钮触发浏览器打印功能）
  - 表格支持排序，点击订单金额、下单时间列标题，按升序 / 降序排列

------

#### 7. 🧪 业务规则与边界条件

| 编号 | 业务规则内容                                                 | 适用场景         |
| ---- | ------------------------------------------------------------ | ---------------- |
| R1   | 同一用户名 / 邮箱只能注册一个账号，注册时校验唯一性          | 用户注册         |
| R2   | 登录失败次数≥5 次，账号锁定 15 分钟，期间不允许再次登录      | 用户登录         |
| R3   | 密码采用加盐哈希存储，不存储明文密码，支持密码找回功能       | 用户认证系统     |
| R4   | 第三方登录（GitHub / 微信）首次授权后，自动创建平台账号，绑定第三方账号 ID | 第三方登录       |
| R5   | 头像上传支持 JPG/PNG 格式，文件大小≤5MB，上传后自动压缩至 1MB 以内，存储至 OSS | 用户资料管理     |
| R6   | 商品图片支持多图上传，主图 1 张，详情图最多 5 张，格式 JPG/PNG，单张大小≤2MB | 商品管理（后台） |
| R7   | 商品库存不足时，无法添加对应数量到购物车，提示 “库存不足，当前库存 XX 件” | 购物车添加商品   |
| R8   | 购物车中商品价格随商品原价实时更新，下单时锁定价格（以订单创建时价格为准） | 购物车、订单创建 |
| R9   | 未登录用户添加的临时购物车，登录后与账号购物车合并，相同商品（同规格）取最大数量 | 购物车数据同步   |
| R10  | 订单创建后 30 分钟内未支付，自动取消订单，释放库存           | 订单时效管理     |
| R11  | 已支付未发货订单，用户可申请取消，取消后自动退款；已发货订单不支持取消 | 订单取消         |
| R12  | 退款申请提交后，商家需在 24 小时内处理，超时未处理自动同意退款 | 退款处理         |
| R13  | 商品上下架状态实时同步至前台，下架商品不显示在商品列表，已加入购物车的下架商品不可结算 | 商品上下架管理   |
| R14  | 搜索关键词长度限制 1-30 位，支持中文、英文、数字，不支持特殊字符（除空格） | 商品搜索         |
| R15  | 批量操作最多支持选择 100 个商品 / 订单，超过时提示 “最多支持选择 100 条数据” | 后台批量操作     |
| R16  | 订单拆单规则：不同商家商品自动拆单；同一商家商品超库存时，可拆分为部分发货订单 | 订单创建         |
| R17  | 支付成功后，支付状态实时同步，同步失败时，通过定时任务每 5 分钟校验一次支付结果 | 支付流程         |
| R18  | 通知发送失败时，触发重试机制，最多重试 3 次，每次间隔 5 分钟，重试失败记录日志 | 支付与通知系统   |

------

#### 8. 📈 埋点与数据指标

| 埋点位置            | 埋点事件名            | 上报字段                                                     | 指标用途                     |
| ------------------- | --------------------- | ------------------------------------------------------------ | ---------------------------- |
| 注册页              | register_click        | 用户设备 ID、注册入口（首页 / 购物车）、时间戳               | 统计注册入口转化率           |
| 注册页              | register_success      | 用户 ID、注册方式（账号注册）、时间戳、设备类型（PC / 移动端） | 统计注册成功率               |
| 登录页              | login_click           | 用户设备 ID、登录入口、时间戳                                | 统计登录入口点击量           |
| 登录页              | login_success         | 用户 ID、登录方式（账号密码 / 第三方）、设备类型、时间戳     | 统计登录成功率、登录方式占比 |
| 登录页              | login_fail            | 失败原因（账号不存在 / 密码错误 / 次数过多）、设备 ID、时间戳 | 分析登录失败原因             |
| 商品列表页          | product_list_view     | 用户 ID（未登录为设备 ID）、分类 ID、排序方式、时间戳        | 统计分类访问量、排序方式偏好 |
| 商品列表页          | product_click         | 用户 ID、商品 ID、分类 ID、时间戳                            | 统计商品点击量、热门商品分析 |
| 商品详情页          | product_detail_view   | 用户 ID、商品 ID、停留时长、时间戳                           | 分析商品详情页停留时间       |
| 商品详情页          | add_to_cart_click     | 用户 ID、商品 ID、规格信息、数量、时间戳                     | 统计加购率、商品加购排行     |
| 商品详情页          | buy_now_click         | 用户 ID、商品 ID、规格信息、数量、时间戳                     | 统计立即购买转化率           |
| 购物车页面          | cart_view             | 用户 ID、商品数量、时间戳                                    | 统计购物车访问频率           |
| 购物车页面          | cart_settlement_click | 用户 ID、选中商品数量、选中商品总价、时间戳                  | 统计购物车结算转化率         |
| 订单确认页          | order_submit_click    | 用户 ID、订单 ID、订单金额、优惠金额、时间戳                 | 统计订单提交率               |
| 订单确认页          | order_submit_success  | 用户 ID、订单 ID、订单金额、支付方式、时间戳                 | 统计订单创建成功率           |
| 支付页              | payment_click         | 用户 ID、订单 ID、支付方式、时间戳                           | 统计支付方式选择率           |
| 支付页              | payment_success       | 用户 ID、订单 ID、支付金额、支付方式、时间戳                 | 统计支付成功率               |
| 支付页              | payment_fail          | 用户 ID、订单 ID、失败原因、支付方式、时间戳                 | 分析支付失败原因             |
| 商品详情页 - 评价区 | comment_view          | 用户 ID、商品 ID、时间戳                                     | 统计评价查看率               |
| 后台商品管理页      | product_add_success   | 管理员 ID、商品 ID、分类 ID、时间戳                          | 统计商品添加效率             |
| 后台订单管理页      | order_ship_click      | 管理员 ID、订单 ID、物流公司、时间戳                         | 统计发货时效                 |

------

#### 9. 🧱 非功能性需求

| 类型       | 具体要求                                                     |
| ---------- | ------------------------------------------------------------ |
| 响应时间   | 页面加载时间≤2 秒（首屏加载≤1.5 秒）；接口响应时间≤1 秒（支付接口≤1.5 秒） |
| 浏览器兼容 | PC 端：Chrome ≥90、Firefox ≥88、Safari ≥14、Edge ≥90；移动端：微信浏览器、Chrome 移动端 |
| 安全性     | 1. 数据传输采用 HTTPS 加密；2. 密码加盐哈希存储，不存储明文；3. 防 SQL 注入（参数化查询）；4. 防 XSS 攻击（输入过滤、输出编码）；5. 防 CSRF 攻击（Token 验证）；6. 敏感接口限流（登录 / 注册接口每分钟≤10 次 / IP） |
| 并发支持   | 支持≥1000 用户同时在线操作；支持≥100 QPS（查询接口）、≥50 QPS（写操作接口） |
| 可用性     | 系统全年可用性≥99.9%；服务中断恢复时间≤10 分钟；数据库每日自动备份，保留 30 天备份 |
| 可扩展性   | 支持商品分类、规格维度动态扩展；支持新增支付方式、通知渠道无需大幅修改代码 |
| 稳定性     | 连续运行 72 小时无异常崩溃；接口错误率≤0.1%；图片存储支持断点续传 |
| 易用性     | 操作步骤简化（注册≤3 步、下单≤5 步）；错误提示清晰易懂，引导用户快速解决 |

------

#### 10. 🧯 异常与错误提示设计

| 编号 | 错误码 | 错误信息                                                     | 适用场景                       | 处理方式                                               |
| ---- | ------ | ------------------------------------------------------------ | ------------------------------ | ------------------------------------------------------ |
| E01  | 20001  | 用户名已被注册，请更换用户名                                 | 用户注册 - 用户名重复          | 提示用户修改用户名，提供用户名建议                     |
| E02  | 20002  | 邮箱已被注册，请更换邮箱或直接登录                           | 用户注册 - 邮箱重复            | 提供 “去登录” 链接，引导用户登录                       |
| E03  | 20003  | 密码格式不正确，需包含大写字母、小写字母和数字，长度 8-20 位 | 用户注册 - 密码不符合规则      | 实时提示密码强度，引导用户修改                         |
| E04  | 20004  | 账号或密码不正确，请重新输入                                 | 用户登录 - 账号密码错误        | 提示用户检查账号密码，提供 “忘记密码” 链接             |
| E05  | 20005  | 登录失败次数过多，请 15 分钟后再试                           | 用户登录 - 次数超限            | 明确告知锁定时间，避免用户重复尝试                     |
| E06  | 20006  | 请选择商品规格                                               | 商品加购 - 未选规格            | 高亮显示规格选择区，提示用户选择                       |
| E07  | 20007  | 库存不足，当前库存 XXX 件                                    | 商品加购 / 下单 - 库存不足     | 限制最大购买数量为当前库存，提示用户调整               |
| E08  | 20008  | 订单创建失败，请刷新页面重试                                 | 订单提交 - 系统异常            | 提供 “刷新页面” 按钮，后台记录错误日志                 |
| E09  | 20009  | 支付超时，请重新提交订单                                     | 支付 - 超时未支付              | 引导用户返回订单列表，重新支付或取消订单               |
| E10  | 20010  | 该商品已下架，无法购买                                       | 加购 / 下单 - 商品下架         | 从购物车中自动移除该商品（提示用户），订单中不允许结算 |
| E11  | 20011  | 请添加收货地址后再提交订单                                   | 订单提交 - 无收货地址          | 提供 “添加地址” 按钮，跳转至地址添加页                 |
| E12  | 20012  | 批量操作最多支持选择 100 条数据                              | 后台批量操作 - 选择过多        | 限制最大选择数量，提示用户减少选择                     |
| E13  | 20013  | 图片格式不支持，请上传 JPG/PNG 格式                          | 头像 / 商品图片上传 - 格式错误 | 提示支持的格式，重新上传                               |
| E14  | 20014  | 图片大小超过限制，请上传≤5MB 的图片                          | 图片上传 - 大小超限            | 提示最大支持大小，提供压缩建议                         |
| E15  | 20015  | 系统异常，请稍后再试（错误码：XXX）                          | 通用系统错误                   | 显示错误码，方便排查，后台记录详细日志                 |

------

#### 11. 📎 其他补充材料

数据库表格设计见 数据库表.md